package cve

type CVERecord struct {
	CVEID          string `gorm:"primaryKey"`
	CurrentVersion int    `gorm:"not null"`
	DateUpdated    string `gorm:"not null"`
}

func (CVERecord) TableName() string {
	return "cve.cve_records"
}

type CVEVersion struct {
	CVEID     string    `gorm:"primaryKey"`
	Version   int       `gorm:"primaryKey"`
	CVEData   []byte    `gorm:"type:jsonb; not null"`
	CVERecord CVERecord `gorm:"foreignKey:CVEID;references:CVEID"`
}

func (CVEVersion) TableName() string {
	return "cve.cve_versions"
}

type CVERecordData struct {
	CVEMetadata CVEMetadata `json:"cveMetadata"`
}

type CVEMetadata struct {
	CVEID       string `json:"cveId"`
	DateUpdated string `json:"dateUpdated"`
}
