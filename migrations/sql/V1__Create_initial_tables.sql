CREATE TABLE IF NOT EXISTS cve.cve_records (
    cve_id VARCHAR(255) PRIMARY KEY,
    current_version INT NOT NULL,
    date_updated VARCHAR(255) NOT NULL
);

CREATE TABLE IF NOT EXISTS cve.cve_versions (
    cve_id VARCHAR(255) NOT NULL,
    version INT NOT NULL,
    cve_data JSONB NOT NULL,
    PRIMARY KEY (cve_id, version),
    FOREIGN KEY (cve_id) REFERENCES cve.cve_records (cve_id) ON DELETE CASCADE ON UPDATE CASCADE
);

CREATE INDEX idx_cve_versions_cve_id ON cve.cve_versions (cve_id);